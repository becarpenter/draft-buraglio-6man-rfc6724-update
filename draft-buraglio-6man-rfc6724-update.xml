<?xml version="1.0" encoding="UTF-8"?>
  <?xml-stylesheet type="text/xsl" href="rfc2629.xslt" ?>
  <!-- generated by https://github.com/cabo/kramdown-rfc version 1.6.31 (Ruby 2.6.10) -->


<!DOCTYPE rfc  [
  <!ENTITY nbsp    "&#160;">
  <!ENTITY zwsp   "&#8203;">
  <!ENTITY nbhy   "&#8209;">
  <!ENTITY wj     "&#8288;">

<!ENTITY RFC2119 SYSTEM "https://bib.ietf.org/public/rfc/bibxml/reference.RFC.2119.xml">
<!ENTITY I-D.ietf-core-coap SYSTEM "https://bib.ietf.org/public/rfc/bibxml3/reference.I-D.ietf-core-coap.xml">
]>


<rfc docName="draft-buraglio-6man-rfc6724-update" category="std" consensus="true">
  <front>
    <title>Updates to host address source selection</title>

    <author initials="N." surname="Buraglio" fullname="Nick Buraglio">
      <organization>Energy Sciences Network</organization>
      <address>
        <postal>
          <street></street> <street></street>
          <country>USA</country>
        </postal>
        <email>buraglio@forwardingplane.net</email>
      </address>
    </author>

    <date year="2023" month="May" day="02"/>

    
    
    

    <abstract>


<t>The behavior of ULA addressing as defined by <eref target="RFC6724"></eref> is preferred below legacy IPv4 addressing, thus rendering ULA IPv6 deployment functionally unusable in IPv4 / IPv6 dual-stacked environments. This behavior is counter to the operational behavior of GUA IPv6 addressing on nearly all modern operating systems that leverage a preference model based on <eref target="RFC6724"></eref>.
This document outlines buth the operational implications of section section 10.6 of <eref target="RFC6724"></eref> as described in <eref target="draft-ietf-v6ops-ula"></eref> and updates the process to better suit operational deployment and management of Unique Local Addressing (ULA) in production.</t>



    </abstract>



  </front>

  <middle>


<section anchor="introduction"><name>Introduction</name>

<t>In modern IPv4 / IPv6 dual-stacked environments, ULA addressing and GUA IPv6 addressing exhibit opposite behavior, which creates difficulties in deployments
leveraging ULA addressing. This conflicting behavior carries planning, operational, and security implications for environments requiring ULA addressing with IPv4/IPv6 dual-stack and prioritization of IPv6 traffic by default, as is the behavior with IPv6 GUA addressing.</t>

<t><vspace blankLines='999' /></t>

<section anchor="defining-well-known-unintended-operational-issues-with-ula"><name>Defining Well Known Unintended Operational Issues With ULA</name>

<t>The <eref target="RFC6724"></eref> definition is incomplete for ULA precedence if a host is operating in a dual-stack environment. 
    As written, <eref target="RFC6724"></eref> section 10.3 states:</t>

<ul empty="true"><li>
  <t>"The default policy table gives IPv6 addresses higher precedence than
IPv4 addresses.  This means that applications will use IPv6 in
preference to IPv4 when the two are equally suitable.  An
administrator can change the policy table to prefer IPv4 addresses by
giving the ::ffff:0.0.0.0/96 prefix a higher precedence".</t>
</li></ul>

<t>Expected behavior would be that ULA address space would be preferred over legacy IPv4, however this is not the case. This presents an acute issue with any environment that will use ULA addressing long side legacy IPv4 that is counter to the standard expectations for legacy IPv4 / IPv6 dual-stack behavior of preferring IPv6, as is performed with GUA addressing. 
Further, <eref target="RFC6724"></eref> Section 10.6 states that this is resolvable by adding a site-specific policy to cause ULAs
within a site to be preferred over global addresses. While theoretically possible, this presents significant issues on devices with inaccessable configuration files as detailed below.</t>

<section anchor="operational-implications"><name>Operational Implications</name>

<t>There are demonstrated and easily repeatable uses cases of ULA not being preferred in some OS and network equipment over legacy IPv4 that necessitate the immediate update to <eref target="RFC6724"></eref>
to better reflect the original intent of the RFC. As with most adjustments to standards, and using <eref target="RFC6724"></eref>
itself as a measurement, this update will likely take between 8-20 years to become common enough for relatively consistent behavior within operating systems. As a reference, as of the time of this writing, it has been 10 years since <eref target="RFC6724"></eref>
has been published but we continue to see existing commercial and open source operating systems exhibiting <eref target="RFC3484"></eref>
behavior. While it should be noted that <eref target="RFC6724"></eref> defines a solution that is functional academically, operationally the solution of adjusting the address preference selection table 
is both operating system dependent and unable to be signaled by any network mechanism such as within a router advertisement, DHCPv6 option, or the like. This lack of an
intra-protocol or network-based ability to adjust address selection preference, along with the inability to adjust a notable number of operating systems either programmatically or manually 
renders operational scalability of such a mechanism functionally untenable.<br />
It is anticipated that any update of <eref target="RFC6724"></eref> would require an additional 8-20 years to be fully realized and properly implemented in a majority of network connected systems. In addition, in the current versions of Linux, 
the priority table (gai.conf) still makes reference to <eref target="RFC3484"></eref>, further demonstrating the long timeframe to have updates reflected in a current, modern operating system. Examples of such out-of-date behavior can be found in printers, cameras, fixed devices, IoT sensors, and longer lifecycle equipment. 
It is especially important to note this behavior in the long lifecycle equipment that exists in industrial control and operational technology environments due to their very long mean time to replacement.
The core issue is the stated interpretation from gai.conf that has the following default:</t>

<figure title="gai.conf example" alt="gai.conf" anchor="scope4"><artwork><![CDATA[
#scopev4  <mask> <value> 
#  Add another rule to the RFC 6724 scope table for IPv4 addresses. 
#    By default the scope IDs described in section 3.2 in RFC 6724 are
#    used.  Changing these defaults should hardly ever be necessary.
#    The defaults are equivalent to:
#
#scopev4 ::ffff:169.254.0.0/112  2
#scopev4 ::ffff:127.0.0.0/104    2
#scopev4 ::ffff:0.0.0.0/96       14
]]></artwork></figure>
<t># Lists</t>

<t><list style="symbols">
  <t>Item1</t>
  <t>Item2
  <list style="symbols">
      <t>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Curabitur nibh mi, mollis varius imperdiet id, venenatis ut nisi. Phasellus mauris urna, ultrices at massa id, faucibus malesuada nisi.</t>
      <t>ItemB</t>
    </list></t>
  <t>Item3</t>
</list></t>

<t>This is a different block to separate the lists.</t>

<t><list style="numbers">
  <t>Item1</t>
  <t>Item2</t>
  <t>ItemA</t>
  <t>ItemB</t>
  <t>Item3
# Figures</t>
</list></t>

<figure title="A Rose" alt="rose" anchor="rose"><artwork><![CDATA[
       _,--._.-,           
      /\_r-,\_ )           
   .-.) _;='_/ (.;         
    \ \'     \/S )         
     L.'-. _.'|-'          
    <_`-'\'_.'/            
      `'-._( \             
             \\       ___  
              \\   .-'_. / 
               \\ /.-'_.'  
                \('--'     
                  \        
]]></artwork></figure>

</section>
</section>
</section>
<section anchor="tables"><name>Tables</name>

<texttable title="Example Table" anchor="exampleTable">
      <ttcol align='left'>Left-aligned</ttcol>
      <ttcol align='center'>Center-aligned</ttcol>
      <ttcol align='right'>Right-aligned</ttcol>
      <c>Alpha</c>
      <c>Bravo</c>
      <c>Charlie</c>
      <c>delta</c>
      <c>echo</c>
      <c>foxtrot</c>
      <c>xylophone</c>
      <c>yankee</c>
      <c>zulu</c>
</texttable>

</section>
<section anchor="refstyle"><name>References</name>

<t>The IETF documents referred to here are <eref target="RFC2119"></eref> and <eref target="I-D.ietf-core-coap"></eref>.  We also refer to <eref target="REST">REST</eref>.  <eref target="a-rose"></eref> and <eref target="exampleTable"></eref> are explicitly tagged, as is <eref target="refstyle"></eref>, but <eref target="security-considerations"></eref> is implicit.  The web page at <eref target="http://ipv.sx/">ipv.sx</eref> is not part of this document.</t>

</section>
<section anchor="security-considerations"><name>Security Considerations</name>

<t>No, really.</t>

</section>
<section anchor="iana-considerations"><name>IANA Considerations</name>

<t>None</t>

</section>


  </middle>

  <back>


    <references title='Normative References'>

&RFC2119;
&I-D.ietf-core-coap;


    </references>

    <references title='Informative References'>

<reference anchor="REST" >
  <front>
    
    <author >
      <organization></organization>
    </author>
    <date year="n.d."/>
  </front>
</reference>


    </references>


<section anchor="lorem-ipsum"><name>Lorem ipsum</name>

<t>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Curabitur nibh mi, mollis varius imperdiet id, venenatis ut nisi. Phasellus mauris urna, ultrices at massa id, faucibus malesuada nisi.</t>

</section>


  </back>

<!-- ##markdown-source:
H4sIAOFxUWQAA91Z23IbNxJ9n69AWQ+SUpyRJWuVhElcK992VetyUrZSflil
FHAGJLEGgQmAocTE3m/f0w3McEhpq/Z1Q1fRnMGtL6dPd0NlWRZRR6Om4ue2
kVEFEZ1YuhCFbBqvQhDBdb5WIiij6qidFUXjaitXWNJ4OY/lrPNyYbQrL1bS
ln5eX3x9dl52vF1RyzgVITZFIbu4dH5aCP6U+X8htA1T8a4SL/I2w0A6452u
Pz0cc34xFa+t8ouN+FBrZWtI/k7FO+c/DZPkbObVeiqGFyF6peJ0eIYY4vGH
2nU2+g2s8uFyeKlWUpup6PX969z5O+kbbRetkVZVVsWisM6vZNRrRce8f/Py
7PT0W/p5Vb6qtIrzsnZe4Uu206LQdr4z/fWH6yRd9gn/3jVcNtielXYNw09k
fvwsyrIU1kUl3uLglbhqQ7cqivSg6UE0zjgvgobPVypOoLwN8LWKnQcKdKtD
DR2FMjpW4iW0n2kasnq2FCs9EStnjA5iLb3ugtCrVsEoKgrdTMRaWWWhYBBd
xIqgK/HTUgJMBlNXsvM04q2ciM5Er8mNMmIgBMnr57Kr9YznGhU62ci0y59B
A3aNnAGVsgZyrpdKzNRSrjV0cXPx89vLPghJeBlEo+baqkbMNuKfvxwBXBRp
xwICtF7Nlfc0poy7E0YtZL0RVz+tz0d7TERcQhCvbKM87UlHYM4Fdm6N26yU
jWLeWY5zacxGdLYLcmYUQJc2O8nzO2nKEGX9CUcqu9beWVodKnG9hDyDHvjN
saQ8EUuEig7GlemAHXX/9nOWZaQz2MYq6SEIpIGXILbtN8Bw2ISoVqCsJSxu
1BrvF0rIbA0iBV6Dc+CvhnYbma0qWFKQWcd6uy4aWBeyI94eSApMGF3zUyBp
QybD/v/Tp9UFvR/7hT0Waq9nOFzz4YkxmQfWF64NZWckJtpGdD394uDWu5qo
FxabqUi2Cx2wPZZn5DBaDeaF6kkPIMfq3zoK+BozL7fmPIK/j0kSHNB0LHgP
w5VuGqOK4gq0148VP4w+NNR74H9CwuQBgCHnY05W90s9Y/VahxDeBsFE3C11
vRS1V2yaRs/nukaUaTxAi60NQpG934N6u30GJBhhDgcybAbU1dJ72ovo23J8
jEw8YYHhX0R43OwCAKy9oytC6rdO+4enizsNMJG9Tvasxbu3HmLoqH/nfcl1
PAuEQJpSnCPkJTSeEJh0Qscgfr/3BZt1pDK7tP/AwQcHB+IVcQdJ9BHMJf5h
3Z0lnCAyQQaN+HGErasQOljlI20PdRIzjYHNPKRZZE2eqB2Mo+A5sgsZAAFY
q4YDUM8RkFxQYOo2dOE+ObbGyJpVyl+XQdzBNpBvsnP4KOKeIaMTMijNPX9C
UmZzidbBWRsRmbsWSK9hB3Z4XOrFEoE1khQsYovnO5ypwGcJPyslbSYa2Y6Q
cKdhzS6otL2mDUbsgwDm7e6WyrLvUKAI6ZUAXJhfKa5JRhxzSWtls4JlKSNE
xqcVNaRaqEQLY6WwdTpoT2CABvtAZbIyrZpO5/hMn1b87+TbC16n78kt+zZ4
Aui8vm8pdTYjnLnO0GNSfwRwEVoJLYfxbRZyiMZxEpoAAncUothDM5JRkrB4
Nag5xyiWB44mqC3rDnjShMSEc2k3Y5AkWQbr70WdcZQddKN2EiEveZiQgCHb
oI4DEZHmoxAfL35AdzvJK2tOZ9O0PlwBdyrwYBDWYS9MRfGm85DA7wL8wzil
JIAn0XvTYb0za0YBGAIbMrtS+aPKABU0cUcPFgcLZwuFgqTgyGOe5fSy77SF
cTNwwCgAPi61YQCi4IoAPuEWTB00BJgkoQbPBb2wdLy0MTkvUNZt1JrrIjaC
trKm7MbyEy3rRZeoR8xxUEhpM6LU7quZKjHYDkWN2Jj5CTFFcdWoFd5Q+GAx
MaySQUNer1rkED6yoyAh1IW+yCIozhQZcWsLWCm4lRI/fuBtbGotKG51m9Ls
HsKTi6wi1TQ5jbGlV3C+pqeU38nmI18X2wyPk6nBSoWH18hkVHUQPXNKp9dY
VTEtkhlXqUf7VxdiSkHYqkdySLmr41gYH6cj6tY5WVgSo4XOc82QvZhF5KAy
+pMyxDWfKOHEOwUC+6Y8eyo2qMdyZVKTgfAFkyM0XbdYctR4ZbijwXKqw8Fm
pMNO1tKPVHGsmhQDeXIMZc2jxkn8W6eswMkaNQMKceysKFiyZNC53slWxTCn
7Wao8pcEK5Tyd4w+7NSxV4ICK99DWBKJlFK+1hQIMCRktX0f/LD6zPXL1tbP
zr/Bsb3CfQBB2rDsmZIasiZB5kFipRDAaabjmOhJa1uWgxslcJ4icadkIYcR
ofVrYbGEkD4X9Lw9SlHbvj6FR0HVuwPA9hWlcotqhVxxdrZPQ1CHwl6a1JkQ
UffhslKUvnRYIdGhkJNBDAzkUW8r6s4QR2iuMg5f/f0lsaxrSSLo5llsAmPO
EYaYl/SyaJ4R5yVK2ehqZ2huPrZM5T6aPEOVG0RMVtimrUHndgw3zhocXBy6
9pENyHGst+1WM8XU/wggdExp1S28XFF7n0gTEqJOT4m/SE1Y2CnqA+b1h1KP
wTYbGXGvNUNc5dqhuGKMgHV1rVs5YIt8kaN6rzdJOTuVrYoTLtJIFmM/znGu
YQ6VRv+eeRXKQXCT6mJ2XiJNiCv/5XzWoMcBAs2momII9qvtkRNayLVAB+4F
vgCJ0DdabxGg9xNRpL5Ip62TD44WUleUQVAURiKtFdgqiJ3yaxSRaMVTuh1l
iT4w2PXEMnN4jBcieNXQlGVy7lXMck7+W0daidf3kuwSBjcC7aWbl+yKUf9h
2byoR5rUlhHhe9B3DSm8xA8Uajg1J9CJuHLXQK8NzmeOJ8EpEem5qje1UdsM
VfWoUFwTMGbgLOcjJWdoyJdCcbdbt1trPLJlAhWzJDdg2jaICk80SVTq3UCX
A6QjwGudcYvNbsPUJNbFadqTvzfpUCqzE9tjEEkb4c7gqrgHoauzXBPmXojL
o4bzpEcsx1xHeLcSPTiS0JQEaMHcGVQU5KrcKkyL4t/DpzgINaRHNhffr2T4
9Fx8v5amU89FcSCok4Z+jiHkO9MrQHlZUFQJXpzBSZlwv5WgTYR4MXR1SQVe
dPVq77Kgb3OeVWf0OJyBKidtgzqmQei/pP4gwzgMDVDoc80S5QAcz6U35R2u
T6TfVGmTUc8U+sZEQ2V2tpsWB1uL5D7i9OLb6uwv59xLnJ6eCXH2cMrZ17nZ
OH16Tqc8nDLqRtLn9Hzshj+mIq04TzehPzwZvKlSZD0BXcft6yfiCxR6S8As
iq/EFYLwNP9/hm7yK/F/f1tISpA6L7Jaz4p0f0W0zzcjiqlzZhwSJNczrfR9
GWrIMCijT6tsmvyDbJN/Xm5/vuiHn8Gmb6g8V2EnSrLPbidlWd1W5WR7hd5f
RJ/c3PpycnMrjvfGqrI6Frff/XB4eyKOqu92192Im0N+ujn5MFqZ9nxbHZaV
uK0OP5eHe+d9f/treXhziLGT0XG9LL9i3e0RNn9kLH9u+sHb29v9sTRYldge
TeDeGA2e8Njhg3UYPDoss7APxsRWoH3kexdUj/tL8R5PGe2ef36hGx1xTSwD
t3wWb9U8lkjNC7oa/ixeUi72oxfv0eUPEz5jwbQsBX9PP9MF0ZTeXZp2KfH2
hZdrR7uAOIxWgsYaZSKNgcppaO7uQfWRh0reavSNd/cb49qls1gsNtJ+UvTj
9850GCX1cgRfp/oxqZnzZdLqyRdS8H2fxoP44wAJOMSNUV/SZdTV6+s3w81t
zvjUtVHe7lvBlPnpzy/pghXPD/8GcwwG/Yj5Jri0C9cM9HcYrMY3jWOhLMn0
wz5jDY4Tbd5TPwpdqDZZLFTT3wBgdi87ChDqO/Cmv1QsuT9qcrYMfJOf7hmJ
eZic79RMtHyrjZW6XVfh/pejZYzt9OQkPZ4c99cpCPg4dEm9dah5piuFdIv5
cufAonjnJlzXmQ3Pu7p8d/nIHKvyLfEM1TfNG7Hpn+IPMcV/AD0oiMQIHQAA

-->

</rfc>

