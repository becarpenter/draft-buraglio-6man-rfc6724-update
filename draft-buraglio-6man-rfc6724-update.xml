<?xml version="1.0" encoding="UTF-8"?>
  <?xml-stylesheet type="text/xsl" href="rfc2629.xslt" ?>
  <!-- generated by https://github.com/cabo/kramdown-rfc version 1.6.31 (Ruby 2.6.10) -->


<!DOCTYPE rfc  [
  <!ENTITY nbsp    "&#160;">
  <!ENTITY zwsp   "&#8203;">
  <!ENTITY nbhy   "&#8209;">
  <!ENTITY wj     "&#8288;">

<!ENTITY RFC2119 SYSTEM "https://bib.ietf.org/public/rfc/bibxml/reference.RFC.2119.xml">
<!ENTITY I-D.ietf-core-coap SYSTEM "https://bib.ietf.org/public/rfc/bibxml3/reference.I-D.ietf-core-coap.xml">
]>


<rfc docName="draft-buraglio-6man-rfc6724-update" category="std" consensus="true">
  <front>
    <title>Updates to host address source selection</title>

    <author initials="T." surname="Chown" fullname="Tim Chown">
      <organization>JISC</organization>
      <address>
        <postal>
          <street></street> <street></street>
          <country>UK</country>
        </postal>
        <email>Tim.Chown@jisc.ac.uk</email>
      </address>
    </author>

    <date year="2023" month="May" day="02"/>

    
    
    

    <abstract>


<t>The behavior of ULA addressing as defined by <eref target="RFC6724"></eref> is preferred below legacy IPv4 addressing, thus rendering ULA IPv6 deployment functionally unusable in IPv4 / IPv6 dual-stacked environments. This behavior is counter to the operational behavior of GUA IPv6 addressing on nearly all modern operating systems that leverage a preference model based on <eref target="RFC6724"></eref>.
This document outlines buth the operational implications of section section 10.6 of <eref target="RFC6724"></eref> as described in <eref target="draft-ietf-v6ops-ula"></eref> and updates the process to better suit operational deployment and management of Unique Local Addressing (ULA) in production.</t>



    </abstract>



  </front>

  <middle>


<section anchor="introduction"><name>Introduction</name>

<t>In modern IPv4 / IPv6 dual-stacked environments, ULA addressing and GUA IPv6 addressing exhibit opposite behavior, which creates difficulties in deployments
leveraging ULA addressing. This conflicting behavior carries planning, operational, and security implications for environments requiring ULA addressing with IPv4/IPv6 dual-stack and prioritization of IPv6 traffic by default, as is the behavior with IPv6 GUA addressing.</t>

<t><vspace blankLines='999' /></t>

<section anchor="defining-well-known-unintended-operational-issues-with-ula"><name>Defining Well Known Unintended Operational Issues With ULA</name>

<t>The <eref target="RFC6724"></eref> definition is incomplete for ULA precedence if a host is operating in a dual-stack environment. 
    As written, <eref target="RFC6724"></eref> section 10.3 states:</t>

<ul empty="true"><li>
  <t>"The default policy table gives IPv6 addresses higher precedence than
IPv4 addresses.  This means that applications will use IPv6 in
preference to IPv4 when the two are equally suitable.  An
administrator can change the policy table to prefer IPv4 addresses by
giving the ::ffff:0.0.0.0/96 prefix a higher precedence".</t>
</li></ul>

<t>Expected behavior would be that ULA address space would be preferred over legacy IPv4, however this is not the case. This presents an acute issue with any environment that will use ULA addressing long side legacy IPv4 that is counter to the standard expectations for legacy IPv4 / IPv6 dual-stack behavior of preferring IPv6, as is performed with GUA addressing. 
Further, <eref target="RFC6724"></eref> Section 10.6 states that this is resolvable by adding a site-specific policy to cause ULAs
within a site to be preferred over global addresses. While theoretically possible, this presents significant issues on devices with inaccessable configuration files as detailed below.</t>

<section anchor="operational-implications"><name>Operational Implications</name>

<t>There are demonstrated and easily repeatable uses cases of ULA not being preferred in some OS and network equipment over legacy IPv4 that necessitate the immediate update to <eref target="RFC6724"></eref>
to better reflect the original intent of the RFC. As with most adjustments to standards, and using <eref target="RFC6724"></eref>
itself as a measurement, this update will likely take between 8-20 years to become common enough for relatively consistent behavior within operating systems. As a reference, as of the time of this writing, it has been 10 years since <eref target="RFC6724"></eref>
has been published but we continue to see existing commercial and open source operating systems exhibiting <eref target="RFC3484"></eref>
behavior. While it should be noted that <eref target="RFC6724"></eref> defines a solution that is functional academically, operationally the solution of adjusting the address preference selection table 
is both operating system dependent and unable to be signaled by any network mechanism such as within a router advertisement, DHCPv6 option, or the like. This lack of an
intra-protocol or network-based ability to adjust address selection preference, along with the inability to adjust a notable number of operating systems either programmatically or manually 
renders operational scalability of such a mechanism functionally untenable.<br />
It is anticipated that any update of <eref target="RFC6724"></eref> would require an additional 8-20 years to be fully realized and properly implemented in a majority of network connected systems. In addition, in the current versions of Linux, 
the priority table (gai.conf) still makes reference to <eref target="RFC3484"></eref>, further demonstrating the long timeframe to have updates reflected in a current, modern operating system. Examples of such out-of-date behavior can be found in printers, cameras, fixed devices, IoT sensors, and longer lifecycle equipment. 
It is especially important to note this behavior in the long lifecycle equipment that exists in industrial control and operational technology environments due to their very long mean time to replacement.
The core issue is the stated interpretation from gai.conf that has the following default:</t>

<figure title="gai.conf example" alt="gai.conf" anchor="scope4"><artwork><![CDATA[
#scopev4  <mask> <value> 
#  Add another rule to the RFC 6724 scope table for IPv4 addresses. 
#    By default the scope IDs described in section 3.2 in RFC 6724 are
#    used.  Changing these defaults should hardly ever be necessary.
#    The defaults are equivalent to:
#
#scopev4 ::ffff:169.254.0.0/112  2
#scopev4 ::ffff:127.0.0.0/104    2
#scopev4 ::ffff:0.0.0.0/96       14
]]></artwork></figure>
<t># Lists</t>

<t><list style="symbols">
  <t>Item1</t>
  <t>Item2
  <list style="symbols">
      <t>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Curabitur nibh mi, mollis varius imperdiet id, venenatis ut nisi. Phasellus mauris urna, ultrices at massa id, faucibus malesuada nisi.</t>
      <t>ItemB</t>
    </list></t>
  <t>Item3</t>
</list></t>

<t>This is a different block to separate the lists.</t>

<t><list style="numbers">
  <t>Item1</t>
  <t>Item2</t>
  <t>ItemA</t>
  <t>ItemB</t>
  <t>Item3
# Figures</t>
</list></t>

<figure title="A Rose" alt="rose" anchor="rose"><artwork><![CDATA[
       _,--._.-,           
      /\_r-,\_ )           
   .-.) _;='_/ (.;         
    \ \'     \/S )         
     L.'-. _.'|-'          
    <_`-'\'_.'/            
      `'-._( \             
             \\       ___  
              \\   .-'_. / 
               \\ /.-'_.'  
                \('--'     
                  \        
]]></artwork></figure>

</section>
</section>
</section>
<section anchor="tables"><name>Tables</name>

<texttable title="Example Table" anchor="exampleTable">
      <ttcol align='left'>Left-aligned</ttcol>
      <ttcol align='center'>Center-aligned</ttcol>
      <ttcol align='right'>Right-aligned</ttcol>
      <c>Alpha</c>
      <c>Bravo</c>
      <c>Charlie</c>
      <c>delta</c>
      <c>echo</c>
      <c>foxtrot</c>
      <c>xylophone</c>
      <c>yankee</c>
      <c>zulu</c>
</texttable>

</section>
<section anchor="refstyle"><name>References</name>

<t>The IETF documents referred to here are <eref target="RFC2119"></eref> and <eref target="I-D.ietf-core-coap"></eref>.  We also refer to <eref target="REST">REST</eref>.  <eref target="a-rose"></eref> and <eref target="exampleTable"></eref> are explicitly tagged, as is <eref target="refstyle"></eref>, but <eref target="security-considerations"></eref> is implicit.  The web page at <eref target="http://ipv.sx/">ipv.sx</eref> is not part of this document.</t>

</section>
<section anchor="security-considerations"><name>Security Considerations</name>

<t>No, really.</t>

</section>
<section anchor="iana-considerations"><name>IANA Considerations</name>

<t>None</t>

</section>


  </middle>

  <back>


    <references title='Normative References'>

&RFC2119;
&I-D.ietf-core-coap;


    </references>

    <references title='Informative References'>

<reference anchor="REST" >
  <front>
    
    <author >
      <organization></organization>
    </author>
    <date year="n.d."/>
  </front>
</reference>


    </references>


<section anchor="lorem-ipsum"><name>Lorem ipsum</name>

<t>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Curabitur nibh mi, mollis varius imperdiet id, venenatis ut nisi. Phasellus mauris urna, ultrices at massa id, faucibus malesuada nisi.</t>

</section>


  </back>

<!-- ##markdown-source:
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

-->

</rfc>

